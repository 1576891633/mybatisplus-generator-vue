package ${pkgPath};

import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import com.github.pagehelper.PageInfo;
import com.github.pagehelper.PageHelper;
import com.kingyon.support.common.exception.ServiceException;

import ${daoPath};
import ${formPath};
import ${queryPath};
import ${modelPath};
import ${servicePath};


@Service
public class ${clzName}ServiceImpl implements I${clzName}Service {

	@Autowired
    private ${clzName}Mapper ${clzNameLC}Mapper;

	/**
	 * 分页查询
	 * @param page 页数
	 * @param size 每页条数
	 * @param sort 排序条件
	 * @param ${clzNameLC} 查询条件
	 * @return
	 */
    public PageInfo findByPage(int page, int size,${queryName} ${clzNameLC},String sort){
        PageHelper.startPage(page, size);
        PageHelper.orderBy(sort);
        List<${clzName}> data = ${clzNameLC}Mapper.findAll(${clzNameLC});
        PageInfo info =new PageInfo(data);
        List<${formName}> response =new ArrayList<>();
        data.stream().forEach(item->response.add(new ${formName}(item)));
        info.setList(response);
        return info;
    }

	/**
	 * 分页查询（默认以创建时间倒序）
	 * @param page 页数
	 * @param size 每页条数
	 * @param ${clzNameLC} 查询条件
	 * @return
	 */
    public PageInfo findByPage(int page, int size,${queryName} ${clzNameLC}){
        PageHelper.startPage(page, size);
        PageHelper.orderBy("create_date desc");
        List<${clzName}> data = ${clzNameLC}Mapper.findAll(${clzNameLC});
        PageInfo info =new PageInfo(data);
        List<${formName}> response =new ArrayList<>();
        data.stream().forEach(item->response.add(new ${formName}(item)));
        info.setList(response);
        return info;
    }

	/**
	 * 分页查询
	 * @param page 页数
	 * @param size 每页条数
	 * @param sort 排序条件
	 * @return
	 */
    public PageInfo findByPage(int page, int size,String sort){
        PageHelper.startPage(page, size);
        PageHelper.orderBy(sort);
        List<${clzName}> data = ${clzNameLC}Mapper.findAll(new ${queryName}());
        PageInfo info =new PageInfo(data);
        List<${formName}> response =new ArrayList<>();
        data.stream().forEach(item->response.add(new ${formName}(item)));
        info.setList(response);
        return info;
    }

	/**
	 * 分页查询（默认以创建时间倒序）
	 * @param page 页数
	 * @param size 每页条数
	 * @return
	 */
    public PageInfo findByPage(int page, int size){
        PageHelper.startPage(page, size);
        PageHelper.orderBy("create_date desc");
        List<${clzName}> data = ${clzNameLC}Mapper.findAll(new ${queryName}());
        PageInfo info =new PageInfo(data);
        List<${formName}> response =new ArrayList<>();
        data.stream().forEach(item->response.add(new ${formName}(item)));
        info.setList(response);
        return info;
    }

	/**
	 * 列表查询
	 * @param ${clzNameLC} 查询条件
	 */
    public List<${formName}> findAll(${queryName} ${clzNameLC}){
        List<${formName}> response =new ArrayList<>();
        ${clzNameLC}Mapper.findAll(${clzNameLC}).stream().forEach(item->response.add(new ${formName}(item)));
        return response;
    }

	/**
	 * 列表查询
	 */
    public List<${formName}> findAll(){
        List<${formName}> response =new ArrayList<>();
        ${clzNameLC}Mapper.findAll(new ${queryName}()).stream().forEach(item->response.add(new ${formName}(item)));
         return response;
    }

	/**
	 * 单个查询
	 */
    public ${formName} getById(${parserKeyType} ${parserKey}){
        return new ${formName}(${clzNameLC}Mapper.getById(${parserKey}));
    }

	/**
	 * 新增
	 * @return 新增id
	 */
    public ${parserKeyType} save(${clzName} ${clzNameLC}){
        if (${clzNameLC}.getId()!=null){
            update(${clzNameLC});
        }else {
            ${clzNameLC}Mapper.save(${clzNameLC});
        }
        return ${clzNameLC}.getId();
    }

	/**
	 * 修改
	 */
    public int update(${clzName} ${clzNameLC}){
        if(${clzNameLC}.getId()==null){
            throw new ServiceException("参数错误");
        }
        return ${clzNameLC}Mapper.update(${clzNameLC});
    }

	/**
	 * 删除
	 */
    public int deleteByIds(${parserKeyType}[] ids){
        return ${clzNameLC}Mapper.deleteByIds(ids);
    }
}
